{"ast":null,"code":"import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, vModelDynamic as _vModelDynamic, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  class: \"row align-items-center justify-content-center\"\n};\nconst _hoisted_3 = {\n  class: \"col-12 col-sm-6 col-md-4 col-lg-4\"\n};\nconst _hoisted_4 = {\n  class: \"card mx-auto shadow\"\n};\nconst _hoisted_5 = {\n  class: \"card-body\"\n};\nconst _hoisted_6 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"card-title\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", null, \"Login\")], -1 /* HOISTED */);\nconst _hoisted_7 = {\n  key: 0,\n  \"close-icon\": \"mdi-close-circle\",\n  value: true,\n  class: \"alert alert-danger\",\n  role: \"alert\",\n  dense: \"\"\n};\nconst _hoisted_8 = {\n  key: 1,\n  \"close-icon\": \"mdi-close-circle\",\n  value: true,\n  class: \"alert alert-danger\",\n  role: \"alert\",\n  dense: \"\"\n};\nconst _hoisted_9 = {\n  class: \"card-text pt-2\"\n};\nconst _hoisted_10 = {\n  class: \"col-md-10 mb-3\"\n};\nconst _hoisted_11 = {\n  class: \"input-group\"\n};\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"input-group-prepend\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"input-group-text\"\n}, \"@\")], -1 /* HOISTED */);\nconst _hoisted_13 = [\"rules\"];\nconst _hoisted_14 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"w-100\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"input-group-prepend\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"input-group-text\"\n}, \"***\")], -1 /* HOISTED */);\nconst _hoisted_16 = [\"type\", \"rules\", \"append-icon\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _ctx.showMsg === 'loginError' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, \" Invalid username or password. Please Try again. \")) : _ctx.showMsg === 'axiosError' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \" Access blocked by server. Check server. \")) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, [_hoisted_12, _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _ctx.credentials.username = $event),\n    counter: 70,\n    label: \"Username\",\n    rules: _ctx.rules.username,\n    maxlength: \"70\",\n    required: \"\",\n    type: \"text\",\n    class: \"form-control mb-3\",\n    placeholder: \"Username\",\n    \"aria-describedby\": \"inputGroupPrepend2\"\n  }, null, 8 /* PROPS */, _hoisted_13), [[_vModelText, _ctx.credentials.username]]), _hoisted_14, _hoisted_15, _withDirectives(_createElementVNode(\"input\", {\n    type: _ctx.showPassword ? 'text' : 'Password',\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.credentials.password = $event),\n    label: \"Password\",\n    rules: _ctx.rules.password,\n    maxlength: \"20\",\n    required: \"\",\n    \"append-icon\": _ctx.showPassword ? 'mdi-eye' : 'mdi-eye-off',\n    \"onClick:append\": _cache[2] || (_cache[2] = $event => _ctx.showPassword = !_ctx.showPassword),\n    class: \"form-control\",\n    placeholder: \"Password\",\n    \"aria-describedby\": \"inputGroupPrepend2\"\n  }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_16), [[_vModelDynamic, _ctx.credentials.password]])])]), _createElementVNode(\"button\", {\n    ref: \"form\",\n    onClick: _cache[3] || (_cache[3] = _withModifiers((...args) => $options.login && $options.login(...args), [\"prevent\"])),\n    class: \"btn btn-primary\"\n  }, \"Login\", 512 /* NEED_PATCH */)])])])])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","value","role","dense","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_ctx","showMsg","_hoisted_7","_hoisted_8","_createCommentVNode","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_cache","$event","credentials","username","counter","label","rules","maxlength","required","type","placeholder","_hoisted_13","_hoisted_14","_hoisted_15","showPassword","password","_hoisted_16","ref","onClick","_withModifiers","args","$options","login"],"sources":["/Users/tbonebrake/Documents/GitHub/Front-end-BookBuddy-Group1-ISQA4900/src/components/Auth.vue"],"sourcesContent":["<template>\n    <div class=\"container\">\n    <div class=\"row align-items-center justify-content-center\">\n      <div class=\"col-12 col-sm-6 col-md-4 col-lg-4\">\n        <div class=\"card mx-auto shadow\">\n          <div class=\"card-body\">\n            <div class=\"card-title\"><span>Login</span></div>\n            <div\n              v-if=\"showMsg === 'loginError'\"\n              close-icon=\"mdi-close-circle\"\n              :value=\"true\"\n              class=\"alert alert-danger\"\n              role=\"alert\"\n              dense\n            >\n              Invalid username or password. Please Try again.\n            </div>\n            <div\n              v-else-if=\"showMsg === 'axiosError'\"\n              close-icon=\"mdi-close-circle\"\n              :value=\"true\"\n              class=\"alert alert-danger\"\n              role=\"alert\"\n              dense\n            >\n              Access blocked by server. Check server.\n            </div>\n            <div class=\"card-text pt-2\">\n              <div class=\"col-md-10 mb-3\">\n                <div class=\"input-group\">\n                  <div class=\"input-group-prepend\">\n                    <span class=\"input-group-text\">@</span>\n                  </div>\n                  <input\n                    v-model=\"credentials.username\"\n                    :counter=\"70\"\n                    label=\"Username\"\n                    :rules=\"rules.username\"\n                    maxlength=\"70\"\n                    required\n                    type=\"text\"\n                    class=\"form-control mb-3\"\n                    placeholder=\"Username\"\n                    aria-describedby=\"inputGroupPrepend2\"\n                  />\n                  <div class=\"w-100\"></div>\n                  <div class=\"input-group-prepend\">\n                    <span class=\"input-group-text\">***</span>\n                  </div>\n                  <input\n                    :type=\"showPassword ? 'text' : 'Password'\"\n                    v-model=\"credentials.password\"\n                    label=\"Password\"\n                    :rules=\"rules.password\"\n                    maxlength=\"20\"\n                    required\n                    :append-icon=\"showPassword ? 'mdi-eye' : 'mdi-eye-off'\"\n                    @click:append=\"showPassword = ! showPassword\"\n                    class=\"form-control\"\n                    placeholder=\"Password\"\n                    aria-describedby=\"inputGroupPrepend2\"\n                  />\n                </div>\n              </div>\n              <button ref =\"form\" @click.prevent=\"login\" class=\"btn btn-primary\">Login</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  </template>\n  \n  <script>\n  import router from '../router';\n  import { APIService } from \"../http/APIService\";\n  const apiService = new APIService();\n  \n  export default {\n  name: \"Auth\",\n  data: () => ({\n      credentials: {},\n      valid: true,\n      showMsg: \"\",\n      loading: false,\n      rules: {\n        username: [\n          (v) => !!v || \"Username is required\",\n          (v) =>\n            (v && v.length > 3) ||\n            \"A username must be more than 3 characters long\",\n          (v) =>\n            /^[a-z0-9_]+$/.test(v) ||\n            \"A username can only contain letters and digits\",\n        ],\n        password: [\n          (v) => !!v || \"Password is required\",\n          (v) =>\n            (v && v.length > 7) ||\n            \"The password must be longer than 7 characters\",\n        ],\n      },\n      showPassword: false,\n    }),\n    methods: {\n      login(){\n            localStorage.clear();\n            localStorage.setItem(\"isAuthenticated\", false)\n  \n            apiService\n            .authenticateLogin(this.credentials)\n            .then((response) => {\n                const access = response.data.access\n                const refresh = response.data.refresh\n  \n                localStorage.setItem(\"access\", access)\n                localStorage.setItem(\"refresh\",refresh)\n                localStorage.setItem(\"isAuthenticated\", true)\n                localStorage.setItem(\"log_user\", JSON.stringify(this.credentials.username))\n              console.log(\"i am here\")\n\n              apiService.getUser()\n              .then((response) => {\n                  this.user = response.data;\n                  console.log(this.user) // print the user details\n                  localStorage.setItem(\"is_superuser\", this.user.is_superuser)\n                    }).catch(error => {\n                    if (error.message ===\"Network Error\"){ // Verify CORS middleware installed in server settings\n                      this.showMsg = \"axiosError\"\n                    }else if (error.response.status === 401) { // \"not authorized\"\n                        this.showMsg = \"loginError\";\n                        router.push(\"/auth\");\n                      }else if (error.response.status === 400) { //\"bad request\"\n                        this.showMsg = \"loginError\";\n                      }else{\n                        this.showMsg = \"axiosError\";\n                        router.push(\"/auth\");\n                      }\n                  });\n\n                window.location = \"/\";\n          }).catch(error => {\n          if (error.message ===\"Network Error\"){ // Verify CORS middleware installed in server settings\n            this.showMsg = \"axiosError\"\n          }else if (error.response.status === 401) { // \"not authorized\"\n              this.showMsg = \"loginError\";\n              router.push(\"/auth\");\n            }else if (error.response.status === 400) { //\"bad request\"\n              this.showMsg = \"loginError\";\n            }else{\n              this.showMsg = \"axiosError\";\n              router.push(\"/auth\");\n            }\n        });\n        }\n    }\n  }\n</script>\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}